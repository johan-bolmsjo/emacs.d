<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Johan Bolmsjö's GNU Emacs Configuration</title>
<meta name="generator" content="Org Mode" />
<style type="text/css">:root{--color-black1:#0a0a0a;--color-black2:#333;--color-gray1:#777;--color-gray2:#ccc;--color-white1:#fafafa;--color-blue1:#0a0ad8;--color-purple1:#6e0ab9;--color-tag:#bbb;--color-headline:#375eab}html{line-height:130%;-webkit-text-size-adjust:100%}body{font-family:serif,serif;font-size:16px;margin-left:2em;max-width:48em;color:var(--color-black1)}@media(pointer:coarse){body{margin-left:0}}h1{font:200% sans-serif}h2{font:180% sans-serif}h3{font:150% sans-serif}h4{font:125% sans-serif}h5{font:110% sans-serif}h1,h2,h3,h4,h5{margin-top:1em;margin-bottom:.5em;color:var(--color-headline)}h2{padding-top:.5rem;border-top:3px dotted var(--color-gray2)}blockquote{border-left:5px solid var(--color-gray2);margin:1em 1.5em;padding-left:1em}tt,code,pre{font-family:monospace,monospace;font-size:90%}pre code{font-size:100%}pre{border:1px solid var(--color-gray2);border-radius:3px;background-color:var(--color-white1);padding:8pt;overflow:auto;margin:0}dt{font-weight:bold}li:not(:last-child){margin-bottom:.2em}hr{border:0;height:1px;background-color:var(--color-black2);margin-top:1.5em}a{border:0;outline:0;color:var(--color-blue1);text-decoration:none}a:visited{color:var(--color-purple1)}a:hover{border-bottom:1px solid}table{margin:1em;border-top:1.5px solid;border-bottom:1.5px solid;border-collapse:collapse}thead{border-bottom:1.5px solid}table td+td,table th+th{border-left:1px solid var(--color-gray1)}table tr{border-top:1px solid var(--color-gray2)}th,td{padding:.3em .6em;vertical-align:middle}td{vertical-align:top}caption.t-above{caption-side:top}caption.t-bottom{caption-side:bottom}caption{margin-bottom:.3em}figcaption{margin-top:.3em}th.org-right{text-align:center}th.org-left{text-align:center}th.org-center{text-align:center}td.org-right{text-align:right}td.org-left{text-align:left}td.org-center{text-align:center}p.verse{margin-left:3%}#postamble p,#preamble p{font-size:90%}#postamble p{margin-top:1.5rem;padding-top:.5rem;border-top:1px solid var(--color-black2)}.title{text-align:center;margin-bottom:.2em}.subtitle{text-align:center;font-size:large;font-weight:bold;margin-top:0}.todo,.done,.priority,.tag{font-family:monospace,monospace}.tag{background-color:#eee;border-radius:3px;font-size:80%;font-weight:normal;padding:2px}.todo{color:red}.done{color:green}.priority{color:orange}.timestamp{color:#bebebe}.timestamp-kwd{color:#5f9ea0}.org-right{margin-left:auto;margin-right:0;text-align:right}.org-left{margin-left:0;margin-right:auto;text-align:left}.org-center{margin-left:auto;margin-right:auto;text-align:center}.underline{text-decoration:underline}.footpara{display:inline}.footdef{margin-bottom:1em}.figure{padding:1em}.figure p{text-align:center}</style>
<link rel="stylesheet" type="text/css" href="https://bitmaster.se/css/org-font-optimized.css" />
</head>
<body>
<div id="content" class="content">
<h1 class="title">Johan Bolmsjö's GNU Emacs Configuration</h1>
<p>
Installation instruction:
</p>
<div class="org-src-container">
<pre class="src src-bash">git clone github.com/johan-bolmsjo/emacs.d ~/.emacs.d
</pre>
</div>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#init-file">1. The Init File</a>
<ul>
<li><a href="#org68ff600">1.1. Overview</a></li>
<li><a href="#orgc01e85c">1.2. Keybindings</a></li>
<li><a href="#orge0b6b34">1.3. User Facing Functions</a></li>
<li><a href="#orgb664aff">1.4. Configuration Adaptations</a></li>
</ul>
</li>
<li><a href="#orgbb84ef4">2. Quick Guides</a>
<ul>
<li><a href="#org5a81886">2.1. Navigation</a></li>
<li><a href="#org240181a">2.2. Incremental Search</a></li>
<li><a href="#org40d21d3">2.3. Completion in Buffers</a></li>
<li><a href="#org61a7e37">2.4. Minibuffer Completion</a></li>
<li><a href="#org11ac5e8">2.5. Magit</a></li>
<li><a href="#orgbc07616">2.6. Denote</a></li>
<li><a href="#org502519d">2.7. Org Mode</a></li>
<li><a href="#org2d015bf">2.8. Text Templates</a></li>
<li><a href="#org144e520">2.9. Diagnostics</a></li>
<li><a href="#org68555a3">2.10. Language Server Protocol Support</a></li>
<li><a href="#org70aaa5a">2.11. Keyboard Macros</a></li>
<li><a href="#org54b58fb">2.12. Debugging Using GDB</a></li>
</ul>
</li>
<li><a href="#org2fe1157">3. Setup of External Tools</a>
<ul>
<li><a href="#org560d360">3.1. Terminal Mode Copy+Paste</a></li>
<li><a href="#orgd93c59b">3.2. Shell Script Mode</a></li>
<li><a href="#orgb6cb655">3.3. PlantUML Documentation</a></li>
<li><a href="#org546bc4c">3.4. Go Programming Language Mode</a></li>
<li><a href="#org58689b9">3.5. OCaml Programming Language Mode</a></li>
<li><a href="#orge2fe087">3.6. Python Programming Language Mode</a></li>
<li><a href="#orgf47b1d2">3.7. Zig Programming Language Mode</a></li>
</ul>
</li>
<li><a href="#orgc41fd85">4. Compiling GNU Emacs</a>
<ul>
<li><a href="#orgf62032b">4.1. Emacs 30.2</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-init-file" class="outline-2">
<h2 id="init-file"><span class="section-number-2">1.</span> The Init File</h2>
<div class="outline-text-2" id="text-init-file">
<p>
Requires GNU Emacs version 30.1 or greater.
</p>

<p>
The main init file is <code>init.el</code>.
This file loads packages that require external programs to function properly.
See chapter <a href="#org2fe1157">3</a> for how to install required programs for specific packages.
</p>
</div>
<div id="outline-container-org68ff600" class="outline-3">
<h3 id="org68ff600"><span class="section-number-3">1.1.</span> Overview</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Overview of enabled packages.
</p>
</div>
<div id="outline-container-org2083b4f" class="outline-4">
<h4 id="org2083b4f"><span class="section-number-4">1.1.1.</span> Package Management</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
Emacs packages are installed using the <a href="https://github.com/radian-software/straight.el">straight</a> package manager.
The advantage with this package manager is that it keeps the complete upstream Git repositories available together with lock files to pin down exact versions.
This means that the Emacs configuration is reproducible.
It's also possible to easily change package versions to resolve incompatibilities when the configuration is
copied between hosts with different Emacs versions.
</p>

<p>
The version lock file <code>~/.emacs.d/straight/versions/default.el</code> is versioned by this Git repository.
</p>

<p>
The actual upstream package source code is not managed by this Git repository.
They are downloaded by Emacs when started.
For local backup purposes it's possible to just archive the whole <code>~/.emacs.d</code> directory.
It's transferable between machines.
</p>
</div>
</div>
<div id="outline-container-org7ff745e" class="outline-4">
<h4 id="org7ff745e"><span class="section-number-4">1.1.2.</span> Documentation Modes</h4>
<div class="outline-text-4" id="text-1-1-2">
<ul class="org-ul">
<li><a href="https://protesilaos.com/emacs/denote">Denote</a> for structured note taking.</li>
<li><a href="https://orgmode.org/">Org Mode</a> for documentation and planning.</li>
<li><a href="https://daringfireball.net/projects/markdown/">Markdown</a></li>
<li><a href="https://plantuml.com/">PlantUML</a></li>
</ul>
</div>
</div>
<div id="outline-container-orgaf39ad1" class="outline-4">
<h4 id="orgaf39ad1"><span class="section-number-4">1.1.3.</span> Data Formats</h4>
<div class="outline-text-4" id="text-1-1-3">
<ul class="org-ul">
<li><a href="https://yaml.org/">YAML</a> through <a href="https://www.emacswiki.org/emacs/YamlMode">yaml-mode</a></li>
</ul>
</div>
</div>
<div id="outline-container-org3062602" class="outline-4">
<h4 id="org3062602"><span class="section-number-4">1.1.4.</span> Programming Languages Modes</h4>
<div class="outline-text-4" id="text-1-1-4">
<p>
All programming language modes except elisp use eglot to provide code navigation and completion support.
Some configuration may be missing for SLIME as I've barely used it.
</p>

<ul class="org-ul">
<li>C/C++ (builtin)</li>
<li><a href="https://lisp-lang.org/">Common Lisp</a> using <a href="https://slime.common-lisp.dev/">SLIME</a></li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/index.html">elisp</a> (builtin)</li>
<li><a href="https://go.dev/">Go</a></li>
<li><a href="https://ocaml.org/">OCaml</a> (externally managed)</li>
<li><a href="https://www.python.org/">Python</a> (builtin)</li>
<li><a href="https://ziglang.org/">Zig</a></li>
</ul>
</div>
</div>
<div id="outline-container-org17a3c96" class="outline-4">
<h4 id="org17a3c96"><span class="section-number-4">1.1.5.</span> Miscellaneous Support Functions</h4>
<div class="outline-text-4" id="text-1-1-5">
<ul class="org-ul">
<li>Improved minibuffer completions through <a href="https://github.com/minad/vertico">Vertico</a>, <a href="https://github.com/minad/marginalia">Marginalia</a> and <a href="https://github.com/oantolin/orderless">Orderless</a>.</li>
<li>Collection of minibuffer utilities provided by <a href="https://github.com/minad/consult">Consult</a>.</li>
<li>Context aware minibuffer actions through <a href="https://github.com/oantolin/embark">Embark</a>.</li>
<li>Code completion through <a href="https://github.com/minad/corfu">Corfu</a> and <a href="https://github.com/oantolin/orderless">Orderless</a>.</li>
<li>Templated auto complete assisted snippets through <a href="https://github.com/joaotavora/yasnippet">Yasnippet</a>.</li>
<li>Project like IDE support using <a href="https://github.com/Alexander-Miller/treemacs">Treemacs</a>, <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Projects.html">project.el</a> and <a href="https://github.com/joaotavora/eglot">Eglot</a>.</li>
<li>Compiler diagnostics through <a href="https://www.flycheck.org/en/latest/">Flycheck</a> or <a href="https://www.gnu.org/software/emacs/manual/html_mono/flymake.html">Flymake</a>.</li>
<li>Git interface through <a href="https://magit.vc/">Magit</a>.</li>
<li>GDB support through <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Debuggers.html">GUD</a>.</li>
<li>Extraneous whitespace indications.</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgc01e85c" class="outline-3">
<h3 id="orgc01e85c"><span class="section-number-3">1.2.</span> Keybindings</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Keybindings that are specific to this configuration file.
</p>
</div>
<div id="outline-container-org672a6d6" class="outline-4">
<h4 id="org672a6d6"><span class="section-number-4">1.2.1.</span> User Keybindings</h4>
<div class="outline-text-4" id="text-1-2-1">
<p>
See <a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Key-Binding-Conventions.html">https://www.gnu.org/software/emacs/manual/html_node/elisp/Key-Binding-Conventions.html</a> for user keybinding conventions.
Also <a href="http://xahlee.info/emacs/emacs/keyboard_shortcuts.html">http://xahlee.info/emacs/emacs/keyboard_shortcuts.html</a> for practical overrides.
</p>

<dl class="org-dl">
<dt><code>C-c a</code></dt><dd><code>align-current</code></dd>
<dt><code>C-c c</code></dt><dd><code>compile</code></dd>
<dt><code>C-c g</code></dt><dd><code>find-grep</code></dd>
<dt><code>C-c i</code></dt><dd><code>ispell-region</code></dd>
<dt><code>C-c o</code></dt><dd><code>ff-find-other-file</code> (in c-mode-common)</dd>
<dt><code>C-c s</code></dt><dd><code>sort-lines</code></dd>
<dt><code>C-c t</code></dt><dd>toggle treemacs pane</dd>
</dl>
</div>
<div id="outline-container-org5ad70e0" class="outline-5">
<h5 id="org5ad70e0">Incremental Search</h5>
<div class="outline-text-5" id="text-org5ad70e0">
<dl class="org-dl">
<dt><code>C-c k</code></dt><dd>Set mark at start of current match and exit isearch (user function).</dd>
</dl>
</div>
</div>
<div id="outline-container-org1de8992" class="outline-5">
<h5 id="org1de8992">Navigation</h5>
<div class="outline-text-5" id="text-org1de8992">
<p>
Even though these functions are called <code>error</code>, they work in many contexts. E.g. moving through compilation errors, grep results, xref references.
</p>

<dl class="org-dl">
<dt><code>F9</code></dt><dd><code>next-error</code></dd>
<dt><code>F10</code></dt><dd><code>prev-error</code> (overrides global menu popup)</dd>
</dl>
</div>
</div>
<div id="outline-container-org3ec9b6a" class="outline-5">
<h5 id="org3ec9b6a">Window Management</h5>
<div class="outline-text-5" id="text-org3ec9b6a">
<p>
Commands useful to prevent Emacs from splitting frames and replacing buffers in windows when doing certain tasks.
</p>

<dl class="org-dl">
<dt><code>C-c F</code></dt><dd>Lock current frame for automatic splitting.</dd>
<dt><code>C-c f</code></dt><dd>Unlock current frame for automatic splitting.</dd>
<dt><code>C-c W</code></dt><dd>Lock current window to its current buffer.</dd>
<dt><code>C-c w</code></dt><dd>Unlock current window from its current buffer.</dd>
</dl>

<p>
See <a href="https://smythp.com/emacs_buffers/">https://smythp.com/emacs_buffers/</a> for an explanation of the frames, windows and buffers terminology.
</p>
</div>
</div>
<div id="outline-container-org5c8c8ad" class="outline-5">
<h5 id="org5c8c8ad">Denote</h5>
<div class="outline-text-5" id="text-org5c8c8ad">
<dl class="org-dl">
<dt><code>C-c n</code></dt><dd>Command prefix</dd>
</dl>

<p>
The main note taking command is <code>C-c n n</code>.
Other keybindings are listed when entering the command prefix.
Discover all commands by entering <code>M-x denote</code>
</p>
</div>
</div>
<div id="outline-container-org1210826" class="outline-5">
<h5 id="org1210826">Org Mode</h5>
<div class="outline-text-5" id="text-org1210826">
<dl class="org-dl">
<dt><code>C-c p</code></dt><dd><code>org-agenda</code> (planning)</dd>
<dt><code>C-c L</code></dt><dd><code>org-store-link</code> (works in other modes to store links)</dd>
</dl>
</div>
</div>
<div id="outline-container-org35701f7" class="outline-5">
<h5 id="org35701f7">Eglot Mode</h5>
<div class="outline-text-5" id="text-org35701f7">
<p>
Note that eglot relies on the keybindings of other packages for most functions.
E.g. xref for navigation and eldoc for documentation.
</p>

<dl class="org-dl">
<dt><code>C-c e a</code></dt><dd><code>eglot-code-actions</code></dd>
<dt><code>C-c e f</code></dt><dd><code>eglot-format</code> (ask server to format buffer or the active region)</dd>
<dt><code>C-c e r</code></dt><dd><code>eglot-rename</code> (rename symbol at point)</dd>
<dt><code>C-c e i</code></dt><dd><code>eglot-find-implementation</code></dd>
<dt><code>C-c e t</code></dt><dd><code>eglot-find-typeDefinition</code></dd>
</dl>
</div>
</div>
<div id="outline-container-org9342222" class="outline-5">
<h5 id="org9342222">Flymake Mode</h5>
<div class="outline-text-5" id="text-org9342222">
<p>
Aligned with flycheck counterparts.
</p>

<dl class="org-dl">
<dt><code>C-c ! l</code></dt><dd><code>flymake-show-buffer-diagnostics</code></dd>
<dt><code>C-c ! n</code></dt><dd><code>flymake-goto-next-error</code></dd>
<dt><code>C-c ! p</code></dt><dd><code>flymake-goto-prev-error</code></dd>
</dl>
</div>
</div>
<div id="outline-container-org726a6ff" class="outline-5">
<h5 id="org726a6ff">Embark</h5>
<div class="outline-text-5" id="text-org726a6ff">
<p>
<a href="https://github.com/oantolin/embark">Embark</a> executes context aware actions.
For example opening the URL that the cursor is placed on in a buffer.
It extends some of the consult commands by making it possible to export the current selection to regular buffers for easier manipulation.
</p>

<dl class="org-dl">
<dt><code>C-c v</code></dt><dd>Execute action on current context</dd>
<dt><code>C-c d</code></dt><dd>"Do what I mean" on current context</dd>
<dt><code>C-h B</code></dt><dd><code>embark-bindings</code>; alternative for `describe-bindings'</dd>
</dl>
</div>
</div>
<div id="outline-container-org42b8d05" class="outline-5">
<h5 id="org42b8d05">GDB (debugger)</h5>
<div class="outline-text-5" id="text-org42b8d05">
<dl class="org-dl">
<dt><code>F5</code></dt><dd>Continue program being debugged.</dd>
<dt><code>F6</code></dt><dd>Step till next source line, do not enter subroutine (next).</dd>
<dt><code>F7</code></dt><dd>Step till next source line, enter subroutine (step).</dd>
<dt><code>F8</code></dt><dd>Execute until current stack frame returns.</dd>
<dt><code>S-F8</code></dt><dd>Stop debugging</dd>
</dl>
</div>
</div>
</div>
<div id="outline-container-org2ed4e50" class="outline-4">
<h4 id="org2ed4e50"><span class="section-number-4">1.2.2.</span> Overridden Keybindings</h4>
<div class="outline-text-4" id="text-1-2-2">
<p>
Modifies standard Emacs behavior or use non-user prefix.
</p>

<dl class="org-dl">
<dt><code>F10</code></dt><dd><code>prev-error</code> (overrides global menu popup)</dd>
<dt><code>M-n</code></dt><dd><code>scroll-up-command</code></dd>
<dt><code>M-p</code></dt><dd><code>scroll-down-command</code></dd>
<dt><code>M-f</code></dt><dd><code>forward-symbol</code> (replaces forward-word)</dd>
<dt><code>M-b</code></dt><dd><code>my/backward-symbol</code> (replaces backward-word)</dd>
<dt><code>C-x k</code></dt><dd><code>my/fast-kill-buffer</code> (replaces kill-buffer)</dd>
</dl>
</div>
</div>
</div>
<div id="outline-container-orge0b6b34" class="outline-3">
<h3 id="orge0b6b34"><span class="section-number-3">1.3.</span> User Facing Functions</h3>
<div class="outline-text-3" id="text-1-3">
<p>
Convenience functions defined by the configuration.
</p>

<dl class="org-dl">
<dt><code>reload-file</code></dt><dd>Calls <code>revert-buffer</code> without asking for confirmation</dd>
</dl>
</div>
</div>
<div id="outline-container-orgb664aff" class="outline-3">
<h3 id="orgb664aff"><span class="section-number-3">1.4.</span> Configuration Adaptations</h3>
<div class="outline-text-3" id="text-1-4">
<p>
Configuration adaptations that may be desired when applying this Emacs configuration in a new environment.
</p>
</div>
<div id="outline-container-org7118c4e" class="outline-4">
<h4 id="org7118c4e"><span class="section-number-4">1.4.1.</span> Terminal Emulator</h4>
<div class="outline-text-4" id="text-1-4-1">
<p>
The solarized theme that is used by this Emacs configuration only works properly in graphical mode and terminals that support true color.
</p>

<p>
The website <a href="https://github.com/termstandard/colors">https://github.com/termstandard/colors</a> describes how to configure terminals and associated tools to support true color.
</p>

<p>
In essence, the environment variable <code>COLORTERM</code> must be set to <code>truecolor</code>.
<code>COLORTERM</code> is distinct from the usual <code>TERM</code> environment variable that communicate terminal capabilities.
Obviously the underlying terminal must also support the true color escape codes.
</p>

<p>
My <code>~/.bashrc</code> contains the following lines to set it for the suckless terminal:
</p>

<div class="org-src-container">
<pre class="src src-bash"># Set the COLORTERM variable to "truecolor" if the terminal supports it.
# The suckless terminal (st) definitely does.
# The tmux-256color can be any underlying type so is technically incorrect;
# it solves the issue of SSH to remote system from within a Tmux session.
if [ "$TERM" = st-256color ] || [ "$TERM" = tmux-256color ]; then
   export COLORTERM=truecolor
fi
</pre>
</div>
</div>
</div>
<div id="outline-container-org102e3d8" class="outline-4">
<h4 id="org102e3d8"><span class="section-number-4">1.4.2.</span> Shell Environment&#xa0;&#xa0;&#xa0;<span class="tag"><span class="optional">optional</span></span></h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
Suggested Emacs shell integration.
</p>

<p>
Set the <code>EDITOR</code> environment variable to emacs in <code>~/.profile</code> or other shell login environment script.
</p>

<div class="org-src-container">
<pre class="src src-bash"># Set preferred editor invoked by some command line tools.
export EDITOR="emacs -nw"
</pre>
</div>

<p>
Add a convenience command alias to e.g. <code>~/.bashrc</code> to open a file in Emacs from a terminal.
</p>

<div class="org-src-container">
<pre class="src src-bash"># Open file in already started Emacs running in server mode (M-x server-start).
# Useful to hide Emacs startup cost when editing config files from the shell.
alias edit='emacsclient -n'
</pre>
</div>
</div>
</div>
<div id="outline-container-org3671365" class="outline-4">
<h4 id="org3671365"><span class="section-number-4">1.4.3.</span> Fonts&#xa0;&#xa0;&#xa0;<span class="tag"><span class="optional">optional</span></span></h4>
<div class="outline-text-4" id="text-1-4-3">
<p>
A personal choice, my current favorite monospaced fonts can be found in the <code>~/.emacs.d/fonts/gofont</code> directory.
</p>

<p>
Installation (Linux):
</p>
<div class="org-src-container">
<pre class="src src-bash">mkdir -p ~/.fonts
cp ~/.emacs.d/fonts/gofont/*.ttf ~/.fonts
</pre>
</div>

<p>
Update <code>~/.emacs.d/fonts.el</code> with your preferred fonts and default size.
</p>
</div>
</div>
<div id="outline-container-org59a2252" class="outline-4">
<h4 id="org59a2252"><span class="section-number-4">1.4.4.</span> Custom Variables</h4>
<div class="outline-text-4" id="text-1-4-4">
<p>
Variables that may need customization (such as file paths) are stored in <code>~/.emacs.d/custom.el</code>.
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-orgbb84ef4" class="outline-2">
<h2 id="orgbb84ef4"><span class="section-number-2">2.</span> Quick Guides</h2>
<div class="outline-text-2" id="text-2">
<p>
Scattered quick guides for my own memory.
It could do with more information for Emacs neophytes.
</p>
</div>
<div id="outline-container-org5a81886" class="outline-3">
<h3 id="org5a81886"><span class="section-number-3">2.1.</span> Navigation</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Xref is used by many Emacs modes for navigation, including Eglot for navigating source code.
</p>

<dl class="org-dl">
<dt><code>M-,</code></dt><dd>Go back</dd>
<dt><code>M-.</code></dt><dd>Find thing</dd>
<dt><code>M-?</code></dt><dd>Find references</dd>
</dl>

<p>
Jump to a specific line.
</p>

<dl class="org-dl">
<dt><code>M-g g</code></dt><dd>goto-line</dd>
</dl>
</div>
</div>
<div id="outline-container-org240181a" class="outline-3">
<h3 id="org240181a"><span class="section-number-3">2.2.</span> Incremental Search</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Don't forget about the occur mode when doing incremental search.
It's very useful to get a navigable outline of all current matches.
</p>

<p>
All keybindings can be listed by invoking <code>C-h b</code> when in search mode.
</p>

<p>
Starting search:
</p>

<dl class="org-dl">
<dt><code>C-s</code></dt><dd>Search forward for a literal string</dd>
<dt><code>C-r</code></dt><dd>Search backward for a literal string</dd>
<dt><code>C-M-s</code></dt><dd>Search forward for a regexp</dd>
<dt><code>C-M-r</code></dt><dd>Search backward for a regexp</dd>
<dt><code>M-s _</code></dt><dd>Search forward for a symbol</dd>
<dt><code>M-s .</code></dt><dd>Search forward for the symbol at point</dd>
</dl>

<p>
During search:
</p>

<dl class="org-dl">
<dt><code>C-s</code></dt><dd>Move to next match (<code>C-s C-s</code> to resume search)</dd>
<dt><code>C-r</code></dt><dd>Move to previous match (<code>C-r C-r</code> to resume search)</dd>
<dt><code>C-g</code></dt><dd>Abort search</dd>
<dt><code>M-c</code></dt><dd>Toggle case sensitive search</dd>
<dt><code>M-e</code></dt><dd>Edit search term</dd>
<dt><code>M-s o</code></dt><dd>Outline of current matches (occur)</dd>
<dt><code>M-s SPC</code></dt><dd>Toggle lax whitespace</dd>
<dt><code>RET</code></dt><dd>Terminate search, leaving cursor at the current match</dd>
</dl>
</div>
</div>
<div id="outline-container-org40d21d3" class="outline-3">
<h3 id="org40d21d3"><span class="section-number-3">2.3.</span> Completion in Buffers</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Completion is provided by <a href="https://github.com/minad/corfu">Corfu</a> together with <a href="https://github.com/oantolin/orderless">Orderless</a>.
Completion is triggered by <code>C-M-i</code> which is bound to <code>complete-symbol</code>.
The TAB key is also configured to either indent (if it can), else complete.
This does not work in the C/C++ mode.
</p>

<p>
The completion mechanism provided by orderless is a bit different and can take some time to get used to.
Multiple patterns (space separated words) can be entered.
Completions candidates that match all patterns regardless of order are kept.
Patterns can be regexps as well as regular words, e.g. <code>^desc</code> match candidates starting with <code>desc</code>.
</p>

<p>
The built-in <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Dynamic-Abbrevs.html">dabbrev</a> mode can also be useful.
</p>

<dl class="org-dl">
<dt><code>M-/</code></dt><dd>dabbrev-expand</dd>
<dt><code>C-M-/</code></dt><dd>dabbrev-completion</dd>
</dl>
</div>
</div>
<div id="outline-container-org61a7e37" class="outline-3">
<h3 id="org61a7e37"><span class="section-number-3">2.4.</span> Minibuffer Completion</h3>
<div class="outline-text-3" id="text-2-4">
<p>
<a href="https://github.com/minad/vertico">Vertico</a> together with <a href="https://github.com/minad/marginalia">Marginalia</a> and <a href="https://github.com/oantolin/orderless">Orderless</a> is used to enhance minibuffer completions.
For example selecting buffers, files or the function to invoke via <code>M-x</code>.
</p>

<dl class="org-dl">
<dt><code>TAB</code>  </dt><dd>Navigate to selected candidate</dd>
<dt><code>RET</code>  </dt><dd>Accept selected candidate</dd>
<dt><code>M-RET</code></dt><dd>Submit exactly what is typed (ignore candidate completion)</dd>
<dt><code>C-g</code>  </dt><dd>Abort (as always)</dd>
</dl>

<p>
Searching for previous selections is done using <code>C-s</code> and <code>C-r</code>.
Navigation is performed using the usual keybindings.
</p>
</div>
</div>
<div id="outline-container-org11ac5e8" class="outline-3">
<h3 id="org11ac5e8"><span class="section-number-3">2.5.</span> Magit</h3>
<div class="outline-text-3" id="text-2-5">
<p>
<a href="https://magit.vc">Magit</a> is a complete text-based user interface to Git.
The magit status command is bound to <code>C-x g</code>.
</p>
</div>
</div>
<div id="outline-container-orgbc07616" class="outline-3">
<h3 id="orgbc07616"><span class="section-number-3">2.6.</span> Denote</h3>
<div class="outline-text-3" id="text-2-6">
<p>
The YouTube presentation <a href="https://www.youtube.com/watch?v=mLzFJcLpDFI">https://www.youtube.com/watch?v=mLzFJcLpDFI</a> by the package author gives a good overview of the note taking workflow.
I recommend studying the <a href="https://protesilaos.com/emacs/denote">manual</a> for further details.
</p>
</div>
</div>
<div id="outline-container-org502519d" class="outline-3">
<h3 id="org502519d"><span class="section-number-3">2.7.</span> Org Mode</h3>
<div class="outline-text-3" id="text-2-7">
<p>
<a href="http://orgmode.org">Org mode</a> is a documentation and planning major mode.
Some HOWTO notes are kept in <a href="docs/howto-org-mode.html">docs/howto-org-mode.html</a>.
</p>

<p>
The <code>org-tempo</code> package is enabled which provides some template instantiation shortcuts.
Invoke <code>M-x describe-variable</code> and enter <code>org-tempo-tags</code> to see all shortcuts.
Useful shortcuts include <code>&lt;s</code> <i>TAB</i> for source blocks and <code>&lt;q</code> <i>TAB</i> for quote blocks.
</p>
</div>
</div>
<div id="outline-container-org2d015bf" class="outline-3">
<h3 id="org2d015bf"><span class="section-number-3">2.8.</span> Text Templates</h3>
<div class="outline-text-3" id="text-2-8">
<p>
Text template support is provided by the <a href="https://github.com/joaotavora/yasnippet">yasnippet</a> package. Sippets are kept under<br />
<code>~/.emacs.d/&lt;MODE&gt;/&lt;FILE&gt;</code> and they are are expanded by typing their name and pressing
<i>TAB</i>.
</p>
</div>
</div>
<div id="outline-container-org144e520" class="outline-3">
<h3 id="org144e520"><span class="section-number-3">2.9.</span> Diagnostics</h3>
<div class="outline-text-3" id="text-2-9">
<p>
Diagnostics such as compiler errors are provied by either the flycheck or flymake package.
</p>
</div>
</div>
<div id="outline-container-org68555a3" class="outline-3">
<h3 id="org68555a3"><span class="section-number-3">2.10.</span> Language Server Protocol Support</h3>
<div class="outline-text-3" id="text-2-10">
<p>
<a href="https://github.com/joaotavora/eglot/blob/master/MANUAL.md">Eglot</a> works in concert with project.el to identify <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Projects.html">projects</a>.
Only version controlled directories can become projects.
Eglot can only analyze files that belongs to a project.
</p>

<p>
Invoke <code>M-x p p</code> to add a project, select the <i>&#x2026; (choose a dir)</i> option.
Tracked projects are stored in <code>~/.emacs.d/projects</code>.
</p>

<p>
Eglot must be started manually from an opened file that belongs to a project.
This is done by invoking <code>M-x eglot</code>.
Eglot may ask for the language server to use if it can't find one or there are multiple choices.
After having done this once, eglot does not prompt for other files in the same project.
</p>

<p>
Eglot is well integrated with core Emacs packages.
Apart from the mentioned xref it use the eldoc package to display documentation and type information.
Invoke <code>C-h .</code> to show documentation at point.
</p>
</div>
</div>
<div id="outline-container-org70aaa5a" class="outline-3">
<h3 id="org70aaa5a"><span class="section-number-3">2.11.</span> Keyboard Macros</h3>
<div class="outline-text-3" id="text-2-11">
<p>
Keyboard macros are incredibly useful to apply repetitive changes in close proximity.
Press <code>F3</code> to start recording key presses.
Press <code>F4</code> to end the recording and bind it to the same key.
</p>
</div>
</div>
<div id="outline-container-org54b58fb" class="outline-3">
<h3 id="org54b58fb"><span class="section-number-3">2.12.</span> Debugging Using GDB</h3>
<div class="outline-text-3" id="text-2-12">
<p>
Activate by <code>M-x gdb</code> followed by <code>M-x gdb-many-windows</code>.
The toolbar contain debugger navigation icons so you may want to enable it using <code>M-x tool-bar-mode</code>.
Keybindings are listed in section <a href="#org42b8d05">GDB (debugger)</a>.
</p>
</div>
</div>
</div>
<div id="outline-container-org2fe1157" class="outline-2">
<h2 id="org2fe1157"><span class="section-number-2">3.</span> Setup of External Tools</h2>
<div class="outline-text-2" id="text-3">
<p>
Unfortunately the <a href="#init-file">Emacs init file</a> is not self contained.
External tools are required to support many packages.
</p>
</div>
<div id="outline-container-org560d360" class="outline-3">
<h3 id="org560d360"><span class="section-number-3">3.1.</span> Terminal Mode Copy+Paste</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Install <code>xclip</code> to make Emacs running in terminal mode copy to the X clipboard.
</p>

<div class="org-src-container">
<pre class="src src-bash">apt install xclip
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd93c59b" class="outline-3">
<h3 id="orgd93c59b"><span class="section-number-3">3.2.</span> Shell Script Mode</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Install the shellcheck linter to get good advice on shell script constructs.
</p>

<p>
Ubuntu/Debian specific instruction:
</p>
<div class="org-src-container">
<pre class="src src-bash">apt install shellcheck
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb6cb655" class="outline-3">
<h3 id="orgb6cb655"><span class="section-number-3">3.3.</span> PlantUML Documentation</h3>
<div class="outline-text-3" id="text-3-3">
<p>
Install <a href="https://plantuml.com/">PlantUML</a>.
</p>

<p>
Ubuntu/Debian specific instruction:
</p>
<div class="org-src-container">
<pre class="src src-bash">apt install plantuml
</pre>
</div>
</div>
</div>
<div id="outline-container-org546bc4c" class="outline-3">
<h3 id="org546bc4c"><span class="section-number-3">3.4.</span> Go Programming Language Mode</h3>
<div class="outline-text-3" id="text-3-4">
<p>
Install the Go programming language toolchain as instructed on <a href="https://go.dev/dl/">https://go.dev/dl/</a>
</p>

<p>
Install required tools:
</p>
<div class="org-src-container">
<pre class="src src-bash">go install golang.org/x/tools/gopls@latest
go install golang.org/x/tools/cmd/goimports@latest
go install golang.org/x/tools/cmd/gorename@latest
go install github.com/rogpeppe/godef@latest
</pre>
</div>
</div>
</div>
<div id="outline-container-org58689b9" class="outline-3">
<h3 id="org58689b9"><span class="section-number-3">3.5.</span> OCaml Programming Language Mode</h3>
<div class="outline-text-3" id="text-3-5">
<p>
Install the OCaml language toolchain from <a href="https://ocaml.org/releases/">https://ocaml.org/releases/</a>
</p>

<p>
Install required tools:
</p>
<div class="org-src-container">
<pre class="src src-bash">opam update
opam switch create 4.13.1
opam install dune utop ocaml-lsp-server merlin tuareg ocp-indent odig
</pre>
</div>

<p>
The OCaml setup is a bit special in that the Emacs packages are installed by the steps above.
Not by the Emacs package manager.
</p>
</div>
</div>
<div id="outline-container-orge2fe087" class="outline-3">
<h3 id="orge2fe087"><span class="section-number-3">3.6.</span> Python Programming Language Mode</h3>
<div class="outline-text-3" id="text-3-6">
</div>
<div id="outline-container-org853d64f" class="outline-4">
<h4 id="org853d64f"><span class="section-number-4">3.6.1.</span> Python Virtual Environments</h4>
<div class="outline-text-4" id="text-3-6-1">
<p>
Pyenv is used to compartmentalize python installations and make it possible to switch between them for different projects.
</p>

<p>
Install pyenv from <a href="https://github.com/pyenv/pyenv">https://github.com/pyenv/pyenv</a>:
</p>

<p>
Clone the pyenv repo:
</p>
<div class="org-src-container">
<pre class="src src-bash">git clone https://github.com/pyenv/pyenv.git ~/.pyenv
cd ~/.pyenv &amp;&amp; src/configure &amp;&amp; make -C src
</pre>
</div>

<p>
Put the following in <code>~/.bashrc</code>:
</p>
<div class="org-src-container">
<pre class="src src-bash">export PYENV_ROOT="$HOME/.pyenv"
if [ -d "$PYENV_ROOT" ]; then
    command -v pyenv &gt;/dev/null || export PATH="$PYENV_ROOT/bin:$PATH"
    eval "$(pyenv init -)"
fi
</pre>
</div>

<p>
Apply the changes in the current shell (or login again):
</p>
<div class="org-src-container">
<pre class="src src-bash">exec "$SHELL"
</pre>
</div>

<p>
Install Python build dependencies (Ubuntu specific, refer to <a href="https://github.com/pyenv/pyenv/wiki#suggested-build-environment">https://github.com/pyenv/pyenv/wiki#suggested-build-environment</a> for other OSes):
</p>
<div class="org-src-container">
<pre class="src src-bash">sudo apt-get update
sudo apt-get install make build-essential libssl-dev zlib1g-dev libbz2-dev \
     libreadline-dev libsqlite3-dev wget curl llvm libncursesw5-dev xz-utils \
     tk-dev libxml2-dev libxmlsec1-dev libffi-dev liblzma-dev
</pre>
</div>

<p>
Install a Python version using pyenv:
</p>
<div class="org-src-container">
<pre class="src src-bash">pyenv install 3.10.7
</pre>
</div>

<p>
Switching between Python versions:
</p>

<dl class="org-dl">
<dt><code>pyenv shell VERSION</code></dt><dd>Select just for current shell session.</dd>
<dt><code>pyenv local VERSION</code></dt><dd>Automatically select whenever you are in the
current directory (or its subdirectories).</dd>
<dt><code>pyenv global VERSION</code></dt><dd>Select globally for your user account.</dd>
</dl>
</div>
</div>
<div id="outline-container-orgd41afaa" class="outline-4">
<h4 id="orgd41afaa"><span class="section-number-4">3.6.2.</span> Language Server</h4>
<div class="outline-text-4" id="text-3-6-2">
<p>
Install the language server:
</p>
<div class="org-src-container">
<pre class="src src-bash">pip install 'python-language-server[all]' scrapy
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgf47b1d2" class="outline-3">
<h3 id="orgf47b1d2"><span class="section-number-3">3.7.</span> Zig Programming Language Mode</h3>
<div class="outline-text-3" id="text-3-7">
<ul class="org-ul">
<li>Install the language toolchain from <a href="https://ziglang.org/download/">https://ziglang.org/download/</a></li>
<li>Install the language server from <a href="https://github.com/zigtools/zls/">https://github.com/zigtools/zls/</a></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgc41fd85" class="outline-2">
<h2 id="orgc41fd85"><span class="section-number-2">4.</span> Compiling GNU Emacs</h2>
<div class="outline-text-2" id="text-4">
<p>
Compiling <a href="https://www.gnu.org/software/emacs/">GNU Emacs</a> from source is quite easy.
Many packages see heavy development and may require a recent version.
</p>
</div>
<div id="outline-container-orgf62032b" class="outline-3">
<h3 id="orgf62032b"><span class="section-number-3">4.1.</span> Emacs 30.2</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Install dependencies (Ubuntu 22.04 specific):
</p>

<div class="org-src-container">
<pre class="src src-bash">sudo apt install \
   libcairo2-dev \
   libgif-dev \
   libgnutls28-dev \
   libharfbuzz-dev \
   libjansson-dev \
   libjpeg-dev \
   libncurses-dev \
   librsvg2-dev \
   libsqlite3-dev \
   libtiff-dev \
   libtree-sitter-dev \
   libxaw7-dev \
   libxml2-dev \
   libxpm-dev
</pre>
</div>

<p>
Install the libgccjit package corresponding to GCC compiler version.
Check compiler version with <code>gcc --version</code>.
</p>

<p>
Example: Install libgccjit corresponding to GCC version
</p>

<div class="org-src-container">
<pre class="src src-bash">apt install libgccjit-11-dev:amd64
</pre>
</div>

<p>
Download, configure, build and install GNU Emacs on Linux:
</p>

<div class="org-src-container">
<pre class="src src-bash">wget https://ftp.acc.umu.se/mirror/gnu.org/gnu/emacs/emacs-30.2.tar.xz
tar xf emacs-30.2.tar.xz
cd emacs-30.2
./configure \
    --with-native-compilation \
    --with-mailutils \
    --with-x-toolkit=lucid \
    --with-tree-sitter \
    --prefix=$HOME/.local
make -j16
make install
</pre>
</div>

<p>
Make sure that Cairo is used for the GUI in the configure stage or some library dependency is missing.
</p>

<p>
Install tree-sitter language grammar files using <code>M-x treesit-install-language-grammar</code>;
example language names: python, c, cpp.
</p>

<p>
See <a href="https://www.masteringemacs.org/article/how-to-get-started-tree-sitter">https://www.masteringemacs.org/article/how-to-get-started-tree-sitter</a> for an introduction to Emacs tree-sitter support and how to use it.
</p>

<p>
For now, none of the tree-sitter major modes are enabled by default.
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: <i>2024-10-05</i></p>
</div>
</body>
</html>
